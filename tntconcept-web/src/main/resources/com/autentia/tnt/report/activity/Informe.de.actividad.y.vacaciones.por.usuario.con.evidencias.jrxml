<?xml version="1.0" encoding="UTF-8"  ?>
<!-- Created with iReport - A designer for JasperReports -->
<!DOCTYPE jasperReport PUBLIC "//JasperReports//DTD Report Design//EN"
        "http://jasperreports.sourceforge.net/dtds/jasperreport.dtd">
<jasperReport
        name="Informe.de.actividad.y.vacaciones.por.usuario.con.evidencias"
        columnCount="1"
        printOrder="Vertical"
        orientation="Landscape"
        pageWidth="842"
        pageHeight="595"
        columnWidth="782"
        columnSpacing="0"
        leftMargin="30"
        rightMargin="30"
        topMargin="20"
        bottomMargin="20"
        whenNoDataType="AllSectionsNoDetail"
        isTitleNewPage="false"
        isSummaryNewPage="false">
    <property name="ireport.scriptlethandling" value="0"/>
    <property name="ireport.encoding" value="UTF-8"/>
    <import value="java.util.*"/>
    <import value="net.sf.jasperreports.engine.*"/>
    <import value="net.sf.jasperreports.engine.data.*"/>
    <import value="com.autentia.tnt.util.ConfigurationUtil"/>
    <import value="com.autentia.tnt.bean.reports.ActivityReportBean"/>

    <parameter name="descripcion" isForPrompting="false" class="java.lang.String">
        <parameterDescription><![CDATA[description]]></parameterDescription>
        <defaultValueExpression>
            <![CDATA["informe.de.actividad.y.vacaciones.por.usuario.con.evidencias.description"]]></defaultValueExpression>
    </parameter>
    <parameter name="Fecha inicio" isForPrompting="true" class="java.sql.Timestamp">
        <parameterDescription><![CDATA[Timestamp]]></parameterDescription>
        <defaultValueExpression><![CDATA[new java.sql.Timestamp(new Date().getTime())]]></defaultValueExpression>
    </parameter>
    <parameter name="Fecha fin" isForPrompting="true" class="java.sql.Timestamp">
        <parameterDescription><![CDATA[Timestamp]]></parameterDescription>
        <defaultValueExpression><![CDATA[new java.sql.Timestamp(new Date().getTime())]]></defaultValueExpression>
    </parameter>
    <parameter name="Usuario" isForPrompting="true" class="java.lang.Integer">
        <parameterDescription><![CDATA[User]]></parameterDescription>
        <defaultValueExpression><![CDATA[new Integer (1)]]></defaultValueExpression>
    </parameter>
    <parameter name="SUBREPORT_HEADER" isForPrompting="false" class="java.lang.String">
        <parameterDescription><![CDATA[Subreport]]></parameterDescription>
        <defaultValueExpression><![CDATA["ourOrganizationName_subreport"]]></defaultValueExpression>
    </parameter>
    <parameter name="SUBREPORT_FOOTER" isForPrompting="false" class="java.lang.String">
        <parameterDescription><![CDATA[Subreport]]></parameterDescription>
        <defaultValueExpression><![CDATA["ourOrganization_subreport"]]></defaultValueExpression>
    </parameter>
    <parameter name="idOrg" isForPrompting="false" class="java.lang.Integer">
        <parameterDescription><![CDATA[Hidden]]></parameterDescription>
        <defaultValueExpression><![CDATA[new Integer (1)]]></defaultValueExpression>
    </parameter>
    <queryString><![CDATA[WITH  RECURSIVE  NaturalDays AS (
    SELECT '2023-01-01' AS calendarDate
    UNION ALL
    SELECT calendarDate + INTERVAL 1 DAY
    FROM NaturalDays
    WHERE
            calendarDate < '2023-12-31'
),
                 WorkingDays (calendarDate) AS (
                     SELECT calendarDate FROM NaturalDays WHERE DAYOFWEEK (calendarDate) NOT IN (1, 7)
                     EXCEPT
                     SELECT date(date) FROM Holiday
                 ),
                 params AS
                    (SELECT $P{Usuario} AS user, $P{Fecha inicio} AS start, $P{Fecha fin} AS end),
                 RegistroActividad AS (
                     SELECT
                         o.name                AS orgName,
                         u.name                AS userName,
                         r.name                AS roleName,
                         p.name                AS proName,
                         TIMESTAMP(a.`start`)  AS start,
                         TIMESTAMP(a.`end`)    AS end,
                         if(a.duration <= 8 * 60 , duration , 8*60) duration,
                         r.timeUnit           AS timeUnit,
                         a.description,
                         a.id                  AS activityId,
                         a.hasEvidences        AS hasEvidences,
                         IF(a.billable = 1, if(a.duration <= 8 * 60 , duration , 8*60), 0) / 60 	AS 'fact',
                         IF(a.billable = 0, if(a.duration <= 8 * 60 , duration , 8*60), 0) / 60 	AS 'noFact',
                         a.insertDate          AS insertDate
                     FROM
                         Activity a,
                         Organization o,
                         User u,
                         Project p,
                         ProjectRole r,
                         params
                     WHERE
                             u.id = params.user
                       AND u.id = a.userId
                       AND r.id = a.roleId
                       AND p.organizationId = o.id
                       AND p.id = r.projectId
                       AND (a.start BETWEEN params.start AND params.end OR a.end BETWEEN params.start AND params.end)
                     UNION
                     SELECT
                         'Vacaciones'               AS orgName,
                         u.name                     AS userName,
                         'Vacaciones'               AS roleName,
                         'Vacaciones'               AS proName,
                         TIMESTAMP(greatest(rh.beginDate, params.start)) AS start,
                         TIMESTAMP(least(rh.finalDate, params.end))      AS end,
                         0                          AS duration,
                         'WORKING_DAYS'             AS timeUnit,
                         rh.userComment             AS description,
                         rh.id                      AS activityId,
                         0                          AS hasEvidences,
                         0                          AS 'fact',
                         0                          AS 'noFact',
                         CURDATE()                  AS insertDate
                     FROM
                         RequestHoliday rh,
                         User u,
                         params
                     WHERE
                             u.id = params.user
                       AND u.id = rh.userId
                       AND (
                             rh.beginDate BETWEEN params.start AND params.end
                             OR rh.finalDate BETWEEN params.start AND params.end
                         )
                 )
SELECT
    IFNULL(nd.calendarDate, wd.calendarDate) as day,
    ra.*
FROM RegistroActividad ra
         LEFT JOIN WorkingDays wd
                   ON ( date(wd.calendarDate) BETWEEN date(ra.start) AND date(ra.end) ) AND ra.timeUnit = 'WORKING_DAYS'
         LEFT JOIN NaturalDays nd
                   ON ( date(nd.calendarDate) BETWEEN date(ra.start) AND date(ra.end) ) AND ra.timeUnit <> 'WORKING_DAYS'
ORDER BY ra.start]]></queryString>

    <field name="day" class="java.sql.Timestamp"/>
    <field name="orgName" class="java.lang.String"/>
    <field name="userName" class="java.lang.String"/>
    <field name="roleName" class="java.lang.String"/>
    <field name="start" class="java.sql.Timestamp"/>
    <field name="insertDate" class="java.sql.Timestamp"/>
    <field name="end" class="java.sql.Timestamp"/>
    <field name="duration" class="java.lang.Integer"/>
    <field name="description" class="java.lang.String"/>
    <field name="hasEvidences" class="java.lang.Integer"/>
    <field name="activityId" class="java.lang.Integer"/>
    <field name="fact" class="java.math.BigDecimal"/>
    <field name="noFact" class="java.math.BigDecimal"/>
    <field name="proName"/>

    <variable name="sumHorasFact" class="java.math.BigDecimal" resetType="Report" calculation="Sum">
        <variableExpression><![CDATA[$F{fact}]]></variableExpression>
    </variable>
    <variable name="sumHorasNoFact" class="java.math.BigDecimal" resetType="Report" calculation="Sum">
        <variableExpression><![CDATA[$F{noFact}]]></variableExpression>
    </variable>

    <background>
        <band height="0" isSplitAllowed="true">
        </band>
    </background>
    <title>
        <band height="81" isSplitAllowed="true">
            <image evaluationTime="Now" hyperlinkType="None" hyperlinkTarget="Self">
                <reportElement
                        x="617"
                        y="12"
                        width="164"
                        height="55"
                        key="image-1"/>
                <box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000"
                     rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
                <graphicElement stretchType="NoStretch"/>
                <imageExpression class="java.io.InputStream">
                    <![CDATA[ConfigurationUtil.getDefault().getLogoAsStream()]]></imageExpression>
            </image>
            <line direction="TopDown">
                <reportElement
                        x="11"
                        y="35"
                        width="600"
                        height="0"
                        key="line-1"/>
                <graphicElement stretchType="NoStretch"/>
            </line>
            <textField isStretchWithOverflow="false" isBlankWhenNull="false" evaluationTime="Now" hyperlinkType="None"
                       hyperlinkTarget="Self">
                <reportElement
                        x="0"
                        y="52"
                        width="614"
                        height="27"
                        key="staticText-1"/>
                <box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000"
                     rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
                <textElement textAlignment="Left">
                    <font pdfFontName="Helvetica-Oblique" isItalic="true"/>
                </textElement>
                <textFieldExpression class="java.lang.String">
                    <![CDATA[$R{informe.de.actividad.y.vacaciones.por.usuario.con.evidencias.description}]]></textFieldExpression>
            </textField>
            <textField isStretchWithOverflow="false" isBlankWhenNull="false" evaluationTime="Now" hyperlinkType="None"
                       hyperlinkTarget="Self">
                <reportElement
                        x="12"
                        y="35"
                        width="67"
                        height="17"
                        key="staticText-2"/>
                <box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000"
                     rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
                <textElement textAlignment="Right">
                    <font fontName="Verdana"/>
                </textElement>
                <textFieldExpression class="java.lang.String"><![CDATA[$R{comun.periodo} + " "]]></textFieldExpression>
            </textField>
            <textField isStretchWithOverflow="false" isBlankWhenNull="false" evaluationTime="Now" hyperlinkType="None"
                       hyperlinkTarget="Self">
                <reportElement
                        x="120"
                        y="35"
                        width="17"
                        height="17"
                        key="staticText-3"/>
                <box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000"
                     rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
                <textElement textAlignment="Center">
                    <font fontName="Verdana"/>
                </textElement>
                <textFieldExpression class="java.lang.String"><![CDATA[$R{comun.al}]]></textFieldExpression>
            </textField>
            <textField isStretchWithOverflow="false" isBlankWhenNull="false" evaluationTime="Now" hyperlinkType="None"
                       hyperlinkTarget="Self">
                <reportElement
                        mode="Opaque"
                        x="387"
                        y="1"
                        width="15"
                        height="12"
                        forecolor="#9999FF"
                        backcolor="#FFFFFF"
                        key="staticText-4"/>
                <box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000"
                     rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
                <textElement textAlignment="Center">
                    <font fontName="Verdana" size="8"/>
                </textElement>
                <textFieldExpression class="java.lang.String"><![CDATA[$R{comun.al}]]></textFieldExpression>
            </textField>
            <textField isStretchWithOverflow="false" isBlankWhenNull="false" evaluationTime="Now" hyperlinkType="None"
                       hyperlinkTarget="Self">
                <reportElement
                        x="5"
                        y="14"
                        width="609"
                        height="20"
                        key="staticText-5"/>
                <box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000"
                     rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
                <textElement textAlignment="Center">
                    <font fontName="Verdana" size="14"/>
                </textElement>
                <textFieldExpression class="java.lang.String">
                    <![CDATA[$R{informe.de.actividad.y.vacaciones.por.usuario.con.evidencias.text1} + " " + $F{userName}]]></textFieldExpression>
            </textField>
            <textField isStretchWithOverflow="true" pattern="dd/MM/yy" isBlankWhenNull="true" evaluationTime="Now"
                       hyperlinkType="None" hyperlinkTarget="Self">
                <reportElement
                        x="357"
                        y="1"
                        width="40"
                        height="12"
                        forecolor="#9999FF"
                        key="textField-1"/>
                <box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000"
                     rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
                <textElement textAlignment="Left">
                    <font fontName="Verdana" size="8"/>
                </textElement>
                <textFieldExpression class="java.util.Date"><![CDATA[$P{Fecha inicio}]]></textFieldExpression>
            </textField>
            <textField isStretchWithOverflow="true" pattern="dd/MM/yy" isBlankWhenNull="true" evaluationTime="Now"
                       hyperlinkType="None" hyperlinkTarget="Self">
                <reportElement
                        x="400"
                        y="1"
                        width="64"
                        height="12"
                        forecolor="#9999FF"
                        key="textField-2"/>
                <box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000"
                     rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
                <textElement textAlignment="Left">
                    <font fontName="Verdana" size="8"/>
                </textElement>
                <textFieldExpression class="java.util.Date"><![CDATA[$P{Fecha fin}]]></textFieldExpression>
            </textField>
            <textField isStretchWithOverflow="false" pattern="dd/MM/yy" isBlankWhenNull="true" evaluationTime="Now"
                       hyperlinkType="None" hyperlinkTarget="Self">
                <reportElement
                        mode="Transparent"
                        x="83"
                        y="35"
                        width="59"
                        height="17"
                        key="textField-3"/>
                <box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000"
                     rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
                <textElement textAlignment="Left">
                    <font fontName="Verdana" pdfFontName="Helvetica-Bold" size="10" isBold="true"/>
                </textElement>
                <textFieldExpression class="java.util.Date"><![CDATA[$P{Fecha inicio}]]></textFieldExpression>
            </textField>
            <textField isStretchWithOverflow="false" pattern="dd/MM/yy" isBlankWhenNull="true" evaluationTime="Now"
                       hyperlinkType="None" hyperlinkTarget="Self">
                <reportElement
                        x="135"
                        y="35"
                        width="86"
                        height="17"
                        key="textField-4"/>
                <box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000"
                     rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
                <textElement textAlignment="Left">
                    <font fontName="Verdana" pdfFontName="Helvetica-Bold" isBold="true"/>
                </textElement>
                <textFieldExpression class="java.util.Date"><![CDATA[$P{Fecha fin}]]></textFieldExpression>
            </textField>
            <subreport isUsingCache="true">
                <reportElement
                        x="214"
                        y="0"
                        width="137"
                        height="12"
                        key="subreport-1"/>
                <subreportParameter name="idOrg">
                    <subreportParameterExpression><![CDATA[$P{idOrg}]]></subreportParameterExpression>
                </subreportParameter>
                <connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
                <subreportExpression class="java.lang.String"><![CDATA[$P{SUBREPORT_HEADER}]]></subreportExpression>
            </subreport>
        </band>
    </title>
    <pageHeader>
        <band height="6" isSplitAllowed="true">
        </band>
    </pageHeader>
    <columnHeader>
        <band height="22" isSplitAllowed="false">
            <rectangle radius="3">
                <reportElement
                        x="4"
                        y="2"
                        width="770"
                        height="20"
                        backcolor="#CCCCFF"
                        key="rectangle-1"/>
                <graphicElement stretchType="NoStretch" pen="None"/>
            </rectangle>
            <textField isStretchWithOverflow="false" isBlankWhenNull="false" evaluationTime="Now" hyperlinkType="None"
                       hyperlinkTarget="Self">
                <reportElement
                        x="0"
                        y="4"
                        width="77"
                        height="12"
                        key="staticText-6"/>
                <box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000"
                     rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
                <textElement textAlignment="Center">
                    <font fontName="Verdana" pdfFontName="Helvetica-Bold" size="6" isBold="true"/>
                </textElement>
                <textFieldExpression>
                    <![CDATA[$R{informe.de.actividad.y.vacaciones.por.usuario.con.evidencias.text14}]]></textFieldExpression>
            </textField>
            <textField isStretchWithOverflow="false" isBlankWhenNull="false" evaluationTime="Now" hyperlinkType="None"
                       hyperlinkTarget="Self">
                <reportElement
                        x="236"
                        y="4"
                        width="77"
                        height="10"
                        key="staticText-6"/>
                <box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000"
                     rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
                <textElement textAlignment="Center">
                    <font fontName="Verdana" pdfFontName="Helvetica-Bold" size="7" isBold="true"/>
                </textElement>
                <textFieldExpression class="java.lang.String">
                    <![CDATA[$R{informe.de.actividad.y.vacaciones.por.usuario.con.evidencias.text10}]]></textFieldExpression>
            </textField>
            <textField isStretchWithOverflow="false" isBlankWhenNull="false" evaluationTime="Now" hyperlinkType="None"
                       hyperlinkTarget="Self">
                <reportElement
                        x="313"
                        y="4"
                        width="66"
                        height="10"
                        key="staticText-7"/>
                <box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000"
                     rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
                <textElement textAlignment="Center">
                    <font fontName="Verdana" pdfFontName="Helvetica-Bold" size="7" isBold="true"/>
                </textElement>
                <textFieldExpression class="java.lang.String">
                    <![CDATA[$R{informe.de.actividad.y.vacaciones.por.usuario.con.evidencias.text3}]]></textFieldExpression>
            </textField>
            <textField isStretchWithOverflow="false" isBlankWhenNull="false" evaluationTime="Now" hyperlinkType="None"
                       hyperlinkTarget="Self">
                <reportElement
                        x="660"
                        y="4"
                        width="66"
                        height="12"
                        key="staticText-8"/>
                <box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000"
                     rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
                <textElement>
                    <font fontName="Verdana" pdfFontName="Helvetica-Bold" size="7" isBold="true"/>
                </textElement>
                <textFieldExpression class="java.lang.String">
                    <![CDATA[$R{informe.de.actividad.y.vacaciones.por.usuario.con.evidencias.text13}]]></textFieldExpression>
            </textField>
            <textField isStretchWithOverflow="false" isBlankWhenNull="false" evaluationTime="Now" hyperlinkType="None"
                       hyperlinkTarget="Self">
                <reportElement
                        x="566"
                        y="4"
                        width="88"
                        height="10"
                        key="staticText-9"/>
                <box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000"
                     rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
                <textElement>
                    <font fontName="Verdana" pdfFontName="Helvetica-Bold" size="7" isBold="true"/>
                </textElement>
                <textFieldExpression class="java.lang.String">
                    <![CDATA[$R{informe.de.actividad.y.vacaciones.por.usuario.con.evidencias.text4}]]></textFieldExpression>
            </textField>
            <textField isStretchWithOverflow="false" isBlankWhenNull="false" evaluationTime="Now" hyperlinkType="None"
                       hyperlinkTarget="Self">
                <reportElement
                        x="79"
                        y="4"
                        width="84"
                        height="12"
                        key="staticText-10"/>
                <box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000"
                     rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
                <textElement textAlignment="Center">
                    <font fontName="Verdana" pdfFontName="Helvetica-Bold" size="7" isBold="true"/>
                </textElement>
                <textFieldExpression class="java.lang.String">
                    <![CDATA[$R{informe.de.actividad.y.vacaciones.por.usuario.con.evidencias.text5}]]></textFieldExpression>
            </textField>
            <textField isStretchWithOverflow="false" isBlankWhenNull="false" evaluationTime="Now" hyperlinkType="None"
                       hyperlinkTarget="Self">
                <reportElement
                        x="458"
                        y="1"
                        width="55"
                        height="16"
                        key="staticText-11"/>
                <box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000"
                     rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
                <textElement textAlignment="Center">
                    <font fontName="Verdana" pdfFontName="Helvetica-Bold" size="6" isBold="true"/>
                </textElement>
                <textFieldExpression class="java.lang.String">
                    <![CDATA[$R{informe.de.actividad.y.vacaciones.por.usuario.con.evidencias.text6}]]></textFieldExpression>
            </textField>
            <textField isStretchWithOverflow="false" isBlankWhenNull="false" evaluationTime="Now" hyperlinkType="None"
                       hyperlinkTarget="Self">
                <reportElement
                        x="500"
                        y="1"
                        width="60"
                        height="16"
                        key="staticText-12"/>
                <box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000"
                     rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
                <textElement textAlignment="Center">
                    <font fontName="Verdana" pdfFontName="Helvetica-Bold" size="6" isBold="true"/>
                </textElement>
                <textFieldExpression class="java.lang.String">
                    <![CDATA[$R{informe.de.actividad.y.vacaciones.por.usuario.con.evidencias.text7}]]></textFieldExpression>
            </textField>
            <textField isStretchWithOverflow="false" isBlankWhenNull="false" evaluationTime="Now" hyperlinkType="None"
                       hyperlinkTarget="Self">
                <reportElement
                        x="152"
                        y="4"
                        width="84"
                        height="12"
                        key="staticText-13"/>
                <box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000"
                     rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
                <textElement textAlignment="Center">
                    <font fontName="Verdana" pdfFontName="Helvetica-Bold" size="7" isBold="true"/>
                </textElement>
                <textFieldExpression class="java.lang.String">
                    <![CDATA[$R{informe.de.actividad.y.vacaciones.por.usuario.con.evidencias.text2}]]></textFieldExpression>
            </textField>
            <textField isStretchWithOverflow="false" isBlankWhenNull="false" evaluationTime="Now" hyperlinkType="None"
                       hyperlinkTarget="Self">
                <reportElement
                        x="380"
                        y="4"
                        width="66"
                        height="10"
                        key="staticText-14"/>
                <box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000"
                     rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
                <textElement textAlignment="Center">
                    <font fontName="Verdana" pdfFontName="Helvetica-Bold" size="7" isBold="true"/>
                </textElement>
                <textFieldExpression class="java.lang.String">
                    <![CDATA[$R{informe.de.actividad.y.vacaciones.por.usuario.con.evidencias.text11}]]></textFieldExpression>
            </textField>
        </band>
    </columnHeader>
    <detail>
        <band height="25" isSplitAllowed="true">
            <textField isStretchWithOverflow="true" pattern="dd/MM/yy" isBlankWhenNull="true" evaluationTime="Now"
                       hyperlinkType="None" hyperlinkTarget="Self">
                <reportElement
                        x="15"
                        y="4"
                        width="47"
                        height="20"
                        key="textField-day"/>
                <box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000"
                     rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
                <textElement textAlignment="Center">
                    <font fontName="Verdana" size="8"/>
                </textElement>
                <textFieldExpression class="java.util.Date"><![CDATA[$F{day}]]></textFieldExpression>
            </textField>
            <textField isStretchWithOverflow="true" pattern="dd/MM/yy HH:mm" isBlankWhenNull="true" evaluationTime="Now"
                       hyperlinkType="None" hyperlinkTarget="Self">
                <reportElement
                        x="320"
                        y="0"
                        width="47"
                        height="20"
                        key="textField-5"/>
                <box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000"
                     rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
                <textElement textAlignment="Center">
                    <font fontName="Verdana" size="8"/>
                </textElement>
                <textFieldExpression class="java.util.Date"><![CDATA[$F{start}]]></textFieldExpression>
            </textField>
            <textField isStretchWithOverflow="true" isBlankWhenNull="true" evaluationTime="Now"
                       hyperlinkType="Reference" hyperlinkTarget="Self">
                <reportElement
                        x="660"
                        y="4"
                        width="100"
                        height="12"
                        key="textField-6"/>
                <box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000"
                     rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
                <textElement textAlignment="Justified">
                    <font fontName="Verdana" size="8"/>
                </textElement>
                <textFieldExpression class="java.lang.String">
                    <![CDATA[$F{hasEvidences}==0 ? "" : ActivityReportBean.getActivityImageUrl($F{activityId},$F{insertDate})]]> </textFieldExpression>
                <hyperlinkReferenceExpression>
                    <![CDATA[$F{hasEvidences}==0 ? "" : ActivityReportBean.getActivityImageUrl($F{activityId},$F{insertDate})]]>
                </hyperlinkReferenceExpression>
            </textField>
            <textField isStretchWithOverflow="true" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"
                       hyperlinkTarget="Self">
                <reportElement
                        x="566"
                        y="4"
                        width="60"
                        height="12"
                        key="textField-6"/>
                <box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000"
                     rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
                <textElement textAlignment="Justified">
                    <font fontName="Verdana" size="8"/>
                </textElement>
                <textFieldExpression class="java.lang.String"><![CDATA[$F{description}]]></textFieldExpression>
            </textField>
            <line direction="TopDown">
                <reportElement
                        x="11"
                        y="21"
                        width="760"
                        height="0"
                        forecolor="#CCCCCC"
                        key="line-2"
                        positionType="Float"/>
                <graphicElement stretchType="NoStretch"/>
            </line>
            <textField isStretchWithOverflow="true" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"
                       hyperlinkTarget="Self">
                <reportElement
                        x="68"
                        y="4"
                        width="84"
                        height="12"
                        key="textField-7"/>
                <box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000"
                     rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
                <textElement textAlignment="Center">
                    <font fontName="Verdana" size="8"/>
                </textElement>
                <textFieldExpression class="java.lang.String"><![CDATA[$F{orgName}]]></textFieldExpression>
            </textField>
            <textField isStretchWithOverflow="true" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"
                       hyperlinkTarget="Self">
                <reportElement
                        x="236"
                        y="4"
                        width="77"
                        height="12"
                        key="textField-8"/>
                <box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000"
                     rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
                <textElement textAlignment="Center">
                    <font fontName="Verdana" size="8"/>
                </textElement>
                <textFieldExpression class="java.lang.String"><![CDATA[$F{roleName}]]></textFieldExpression>
            </textField>
            <textField isStretchWithOverflow="true" pattern="#,##0.00" isBlankWhenNull="true" evaluationTime="Now"
                       hyperlinkType="None" hyperlinkTarget="Self">
                <reportElement
                        x="445"
                        y="4"
                        width="55"
                        height="12"
                        key="textField-9"/>
                <box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000"
                     rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
                <textElement textAlignment="Center">
                    <font fontName="Verdana" size="8"/>
                </textElement>
                <textFieldExpression class="java.math.BigDecimal"><![CDATA[$F{fact}]]></textFieldExpression>
            </textField>
            <textField isStretchWithOverflow="true" pattern="#,##0.00" isBlankWhenNull="true" evaluationTime="Now"
                       hyperlinkType="None" hyperlinkTarget="Self">
                <reportElement
                        x="500"
                        y="4"
                        width="60"
                        height="12"
                        key="textField-10"/>
                <box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000"
                     rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
                <textElement textAlignment="Center">
                    <font fontName="Verdana" size="8"/>
                </textElement>
                <textFieldExpression class="java.math.BigDecimal"><![CDATA[$F{noFact}]]></textFieldExpression>
            </textField>
            <textField isStretchWithOverflow="true" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"
                       hyperlinkTarget="Self">
                <reportElement
                        x="152"
                        y="4"
                        width="84"
                        height="12"
                        key="textField-11"/>
                <box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000"
                     rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
                <textElement textAlignment="Center">
                    <font fontName="Verdana" size="8"/>
                </textElement>
                <textFieldExpression class="java.lang.String"><![CDATA[$F{proName}]]></textFieldExpression>
            </textField>
            <textField isStretchWithOverflow="true" pattern="dd/MM/yy HH:mm" isBlankWhenNull="true" evaluationTime="Now"
                       hyperlinkType="None" hyperlinkTarget="Self">
                <reportElement
                        x="390"
                        y="0"
                        width="46"
                        height="20"
                        key="textField-12"/>
                <box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000"
                     rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
                <textElement textAlignment="Center">
                    <font fontName="Verdana" size="8"/>
                </textElement>
                <textFieldExpression class="java.util.Date"><![CDATA[$F{end}]]></textFieldExpression>
            </textField>
        </band>
    </detail>
    <columnFooter>
        <band height="2" isSplitAllowed="true">
        </band>
    </columnFooter>
    <pageFooter>
        <band height="50" isSplitAllowed="true">
            <textField isStretchWithOverflow="false" isBlankWhenNull="false" evaluationTime="Now" hyperlinkType="None"
                       hyperlinkTarget="Self">
                <reportElement
                        x="658"
                        y="28"
                        width="100"
                        height="18"
                        key="textField-13"/>
                <box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000"
                     rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
                <textElement textAlignment="Right">
                    <font fontName="Verdana" size="8"/>
                </textElement>
                <textFieldExpression class="java.lang.String">
                    <![CDATA[$R{comun.pagina} + " " + $V{PAGE_NUMBER} + " " + $R{comun.de} + " "]]></textFieldExpression>
            </textField>
            <textField isStretchWithOverflow="false" isBlankWhenNull="false" evaluationTime="Report"
                       hyperlinkType="None" hyperlinkTarget="Self">
                <reportElement
                        x="760"
                        y="28"
                        width="20"
                        height="18"
                        key="textField-14"/>
                <box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000"
                     rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
                <textElement>
                    <font fontName="Verdana" size="8"/>
                </textElement>
                <textFieldExpression class="java.lang.String">
                    <![CDATA["" + $V{PAGE_NUMBER} + ""]]></textFieldExpression>
            </textField>
            <textField isStretchWithOverflow="false" pattern="EEEEE dd MMMMM yyyy" isBlankWhenNull="false"
                       evaluationTime="Report" hyperlinkType="None" hyperlinkTarget="Self">
                <reportElement
                        x="22"
                        y="28"
                        width="230"
                        height="18"
                        key="textField-15"/>
                <box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000"
                     rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
                <textElement>
                    <font fontName="Verdana" size="8"/>
                </textElement>
                <textFieldExpression class="java.util.Date"><![CDATA[new java.util.Date()]]></textFieldExpression>
            </textField>
            <line direction="TopDown">
                <reportElement
                        x="12"
                        y="24"
                        width="760"
                        height="0"
                        key="line-3"/>
                <graphicElement stretchType="NoStretch" pen="1Point"/>
            </line>
            <subreport isUsingCache="true">
                <reportElement
                        x="126"
                        y="13"
                        width="531"
                        height="16"
                        key="subreport-2"/>
                <subreportParameter name="idOrg">
                    <subreportParameterExpression><![CDATA[$P{idOrg}]]></subreportParameterExpression>
                </subreportParameter>
                <connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
                <subreportExpression class="java.lang.String"><![CDATA[$P{SUBREPORT_FOOTER}]]></subreportExpression>
            </subreport>
        </band>
    </pageFooter>
    <summary>
        <band height="86" isSplitAllowed="true">
            <textField isStretchWithOverflow="false" isBlankWhenNull="false" evaluationTime="Now" hyperlinkType="None"
                       hyperlinkTarget="Self">
                <reportElement
                        x="83"
                        y="29"
                        width="102"
                        height="14"
                        key="staticText-15"/>
                <box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000"
                     rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
                <textElement textAlignment="Right">
                    <font fontName="Verdana" pdfFontName="Helvetica" size="8" isBold="false"/>
                </textElement>
                <textFieldExpression class="java.lang.String">
                    <![CDATA[$R{informe.de.actividad.y.vacaciones.por.usuario.con.evidencias.text8}]]></textFieldExpression>
            </textField>
            <textField isStretchWithOverflow="false" isBlankWhenNull="false" evaluationTime="Now" hyperlinkType="None"
                       hyperlinkTarget="Self">
                <reportElement
                        x="83"
                        y="46"
                        width="102"
                        height="14"
                        key="staticText-16"/>
                <box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000"
                     rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
                <textElement textAlignment="Right">
                    <font fontName="Verdana" size="8"/>
                </textElement>
                <textFieldExpression class="java.lang.String">
                    <![CDATA[$R{informe.de.actividad.y.vacaciones.por.usuario.con.evidencias.text9}]]></textFieldExpression>
            </textField>
            <textField isStretchWithOverflow="true" pattern="###0.00" isBlankWhenNull="true" evaluationTime="Now"
                       hyperlinkType="None" hyperlinkTarget="Self">
                <reportElement
                        x="188"
                        y="29"
                        width="329"
                        height="14"
                        key="textField-19"/>
                <box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000"
                     rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
                <textElement textAlignment="Left">
                    <font fontName="Verdana" pdfFontName="Helvetica-Bold" size="8" isBold="true"/>
                </textElement>
                <textFieldExpression class="java.math.BigDecimal"><![CDATA[$V{sumHorasFact}]]></textFieldExpression>
            </textField>
            <textField isStretchWithOverflow="true" pattern="###0.00" isBlankWhenNull="true" evaluationTime="Now"
                       hyperlinkType="None" hyperlinkTarget="Self">
                <reportElement
                        x="188"
                        y="46"
                        width="329"
                        height="14"
                        key="textField-20"/>
                <box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000"
                     rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
                <textElement>
                    <font fontName="Verdana" pdfFontName="Helvetica-Bold" size="8" isBold="true"/>
                </textElement>
                <textFieldExpression class="java.math.BigDecimal"><![CDATA[$V{sumHorasNoFact}]]></textFieldExpression>
            </textField>
            <textField isStretchWithOverflow="true" pattern="###0.00" isBlankWhenNull="true" evaluationTime="Now"
                       hyperlinkType="None" hyperlinkTarget="Self">
                <reportElement
                        x="188"
                        y="64"
                        width="329"
                        height="14"
                        key="textField-21"/>
                <box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000"
                     rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
                <textElement>
                    <font fontName="Verdana" pdfFontName="Helvetica-Bold" size="8" isBold="true"/>
                </textElement>
            </textField>
        </band>
    </summary>
</jasperReport>
